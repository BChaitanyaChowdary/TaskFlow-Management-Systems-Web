{"ast":null,"code":"import React,{useState}from'react';import{useQuery,useMutation,useQueryClient}from'react-query';import{projectsAPI,authAPI,tasksAPI}from'../../services/api';import Card from'../UI/Card';import Button from'../UI/Button';import Select from'../UI/Select';import Badge from'../UI/Badge';import LoadingSpinner from'../UI/LoadingSpinner';import ConfirmModal from'../UI/ConfirmModal';import{Users,Plus,X,User}from'lucide-react';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProjectMembersModal=_ref=>{var _projectTasks$data;let{project,isOpen,onClose}=_ref;const queryClient=useQueryClient();const[showAddForm,setShowAddForm]=useState(false);const[selectedUser,setSelectedUser]=useState('');const[selectedTasks,setSelectedTasks]=useState([]);const[showConfirmModal,setShowConfirmModal]=useState(false);const[memberToRemove,setMemberToRemove]=useState(null);// Fetch project members\nconst{data:members,isLoading:membersLoading}=useQuery(['projectMembers',project===null||project===void 0?void 0:project.id],()=>projectsAPI.getProjectMembers(project.id),{enabled:!!project&&isOpen});// Fetch per-member performance for this project (Scrum Master view)\nconst{data:performanceData}=useQuery(['projectMemberPerformance',project===null||project===void 0?void 0:project.id],()=>projectsAPI.getProjectMemberPerformance(project.id),{enabled:!!project&&isOpen});// Fetch all employees for adding to project\nconst{data:employees}=useQuery('employees',()=>authAPI.getEmployees().then(res=>res.data||res),{enabled:showAddForm,onSuccess:data=>{console.log('Employees data in ProjectMembersModal:',data);console.log('Is array:',Array.isArray(data));},onError:error=>{console.error('Error fetching employees:',error);}});// Fetch project tasks for assignment\nconst{data:projectTasks}=useQuery(['projectTasks',project===null||project===void 0?void 0:project.id],()=>tasksAPI.getTasks({project:project.id}),{enabled:!!project&&showAddForm,onSuccess:data=>{console.log('Project tasks data:',data);},onError:error=>{console.error('Error fetching project tasks:',error);}});// Add member mutation\nconst addMemberMutation=useMutation(async memberData=>{// First add the member to the project\nconst memberResponse=await projectsAPI.addProjectMember(project.id,{user:memberData.user,role:'employee'// Default role\n});// Then assign tasks if any are selected\nif(memberData.tasks&&memberData.tasks.length>0){for(const taskId of memberData.tasks){await tasksAPI.updateTask(taskId,{assignee:memberData.user});}}return memberResponse;},{onSuccess:()=>{// Invalidate all relevant queries to update everywhere\nqueryClient.invalidateQueries(['projectMembers',project.id]);queryClient.invalidateQueries(['projectTasks',project.id]);queryClient.invalidateQueries(['projectMemberPerformance',project.id]);queryClient.invalidateQueries(['taskAnalytics']);queryClient.invalidateQueries(['smProjects']);queryClient.invalidateQueries(['assignedProjects']);queryClient.invalidateQueries(['projectSpecificAnalytics',project.id]);setSelectedUser('');setSelectedTasks([]);setShowAddForm(false);toast.success('Member added and tasks assigned successfully');},onError:error=>{var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Failed to add member');}});// Remove member mutation\nconst removeMemberMutation=useMutation(memberId=>projectsAPI.removeProjectMember(project.id,memberId),{onSuccess:()=>{queryClient.invalidateQueries(['projectMembers',project.id]);toast.success('Member removed successfully');},onError:error=>{var _error$response2,_error$response2$data;toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||'Failed to remove member');}});const handleAddMember=e=>{e.preventDefault();if(!selectedUser){toast.error('Please select a user');return;}addMemberMutation.mutate({user:selectedUser,tasks:selectedTasks});};const handleTaskToggle=taskId=>{setSelectedTasks(prev=>prev.includes(taskId)?prev.filter(id=>id!==taskId):[...prev,taskId]);};const handleRemoveMember=memberId=>{setMemberToRemove(memberId);setShowConfirmModal(true);};const handleConfirmRemove=()=>{if(memberToRemove){removeMemberMutation.mutate(memberToRemove);}setShowConfirmModal(false);setMemberToRemove(null);};const handleCancelRemove=()=>{setShowConfirmModal(false);setMemberToRemove(null);};if(!isOpen||!project)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\",onClick:onClose}),/*#__PURE__*/_jsx(\"div\",{className:\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:[\"Manage - \",project.name]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"See assigned people, their history and completion rates\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(X,{className:\"h-6 w-6\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsxs(Button,{onClick:()=>setShowAddForm(!showAddForm),className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"h-4 w-4\"}),\"Add Member\"]})}),showAddForm&&/*#__PURE__*/_jsx(Card,{className:\"p-4 mb-4\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddMember,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(Select,{label:\"Select Employee *\",value:selectedUser,onChange:e=>setSelectedUser(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose an employee...\"}),Array.isArray(employees)&&employees.map(employee=>/*#__PURE__*/_jsxs(\"option\",{value:employee.id,children:[employee.first_name,\" \",employee.last_name,\" (\",employee.email,\")\"]},employee.id))]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Assign Tasks (Optional)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3 space-y-2\",children:(projectTasks===null||projectTasks===void 0?void 0:(_projectTasks$data=projectTasks.data)===null||_projectTasks$data===void 0?void 0:_projectTasks$data.length)>0?projectTasks.data.map(task=>{var _task$status;return/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedTasks.includes(task.id),onChange:()=>handleTaskToggle(task.id),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900 truncate\",children:task.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\"Status: \",(_task$status=task.status)===null||_task$status===void 0?void 0:_task$status.replace('_',' ').toUpperCase(),task.priority&&\" \\u2022 Priority: \".concat(task.priority)]})]})]},task.id);}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-gray-500 text-sm\",children:\"No tasks available for this project\"})}),selectedTasks.length>0&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600 mt-1\",children:[selectedTasks.length,\" task\",selectedTasks.length!==1?'s':'',\" selected\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",loading:addMemberMutation.isLoading,disabled:addMemberMutation.isLoading,size:\"sm\",children:\"Add Member\"}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:()=>{setShowAddForm(false);setSelectedUser('');setSelectedTasks([]);},size:\"sm\",children:\"Cancel\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:membersLoading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center py-8\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"md\"})}):((_members$data,_performanceData$data)=>{// Normalize members response to a flat array\nconst list=Array.isArray(members)?members:Array.isArray(members===null||members===void 0?void 0:members.data)?members.data:(members===null||members===void 0?void 0:(_members$data=members.data)===null||_members$data===void 0?void 0:_members$data.results)||(members===null||members===void 0?void 0:members.data)||[];const perfMembers=(performanceData===null||performanceData===void 0?void 0:(_performanceData$data=performanceData.data)===null||_performanceData$data===void 0?void 0:_performanceData$data.members)||[];// Create a Set to track unique user IDs to prevent duplicates\nconst seenUserIds=new Set();// Build combined list with proper deduplication\nconst combined=[];// First, add explicit members\nlist.forEach(m=>{if(!seenUserIds.has(m.user)){seenUserIds.add(m.user);combined.push({id:m.id,user:m.user,user_name:m.user_name,user_email:m.user_email,role:m.role,isExplicitMember:true});}});// Then add performance members who aren't already explicit members\nperfMembers.forEach(p=>{if(!seenUserIds.has(p.user_id)){seenUserIds.add(p.user_id);combined.push({id:\"assignee-\".concat(p.user_id),user:p.user_id,user_name:p.name,user_email:p.email,role:'employee',isExplicitMember:false});}});if(!combined.length){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(Users,{className:\"h-12 w-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No members assigned yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Add members to get started\"})]});}return(Array.isArray(combined)?combined:[]).map(member=>/*#__PURE__*/_jsxs(Card,{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(User,{className:\"h-5 w-5 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-900\",children:member.user_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:member.user_email}),/*#__PURE__*/_jsx(Badge,{variant:member.role==='scrum_master'?'primary':'gray',size:\"sm\",className:\"mt-1\",children:member.role==='scrum_master'?'Scrum Master':member.isExplicitMember?'Employee':'Assignee'})]})]}),member.isExplicitMember&&/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>handleRemoveMember(member.id),className:\"text-red-600 hover:text-red-800\",children:\"Remove\"})]}),((_performanceData$data2,_performanceData$data3,_perf$recent_tasks)=>{const perf=performanceData===null||performanceData===void 0?void 0:(_performanceData$data2=performanceData.data)===null||_performanceData$data2===void 0?void 0:(_performanceData$data3=_performanceData$data2.members)===null||_performanceData$data3===void 0?void 0:_performanceData$data3.find(p=>p.user_id===member.user);if(!perf)return null;const rate=perf.total_tasks?Math.round(perf.completed_tasks/perf.total_tasks*100):0;return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-sm text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Completion Rate\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[rate,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-500 h-2 rounded-full\",style:{width:\"\".concat(rate,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 grid grid-cols-4 gap-3 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Total\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold\",children:perf.total_tasks})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Done\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold\",children:perf.completed_tasks})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold\",children:perf.in_progress_tasks})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"To Do\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold\",children:perf.todo_tasks})]})]}),(_perf$recent_tasks=perf.recent_tasks)!==null&&_perf$recent_tasks!==void 0&&_perf$recent_tasks.length?/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mb-1\",children:\"Recent tasks\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1 text-sm text-gray-700\",children:Array.isArray(perf.recent_tasks)&&perf.recent_tasks.map(t=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"truncate mr-2\",children:t.title}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:t.status.replace('_',' ')})]},t.id))})]}):null]});})()]},member.id));})()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-t border-gray-200\",children:/*#__PURE__*/_jsx(Button,{onClick:onClose,className:\"w-full\",children:\"Close\"})})]})})]}),/*#__PURE__*/_jsx(ConfirmModal,{isOpen:showConfirmModal,title:\"Remove Member\",description:\"Are you sure you want to remove this member from the project? This action cannot be undone.\",confirmText:\"Remove Member\",cancelText:\"Cancel\",variant:\"danger\",onConfirm:handleConfirmRemove,onCancel:handleCancelRemove,isSubmitting:removeMemberMutation.isLoading})]});};export default ProjectMembersModal;","map":{"version":3,"names":["React","useState","useQuery","useMutation","useQueryClient","projectsAPI","authAPI","tasksAPI","Card","Button","Select","Badge","LoadingSpinner","ConfirmModal","Users","Plus","X","User","toast","jsx","_jsx","jsxs","_jsxs","ProjectMembersModal","_ref","_projectTasks$data","project","isOpen","onClose","queryClient","showAddForm","setShowAddForm","selectedUser","setSelectedUser","selectedTasks","setSelectedTasks","showConfirmModal","setShowConfirmModal","memberToRemove","setMemberToRemove","data","members","isLoading","membersLoading","id","getProjectMembers","enabled","performanceData","getProjectMemberPerformance","employees","getEmployees","then","res","onSuccess","console","log","Array","isArray","onError","error","projectTasks","getTasks","addMemberMutation","memberData","memberResponse","addProjectMember","user","role","tasks","length","taskId","updateTask","assignee","invalidateQueries","success","_error$response","_error$response$data","response","detail","removeMemberMutation","memberId","removeProjectMember","_error$response2","_error$response2$data","handleAddMember","e","preventDefault","mutate","handleTaskToggle","prev","includes","filter","handleRemoveMember","handleConfirmRemove","handleCancelRemove","className","children","onClick","name","onSubmit","label","value","onChange","target","required","map","employee","first_name","last_name","email","task","_task$status","type","checked","title","status","replace","toUpperCase","priority","concat","loading","disabled","size","variant","_members$data","_performanceData$data","list","results","perfMembers","seenUserIds","Set","combined","forEach","m","has","add","push","user_name","user_email","isExplicitMember","p","user_id","member","_performanceData$data2","_performanceData$data3","_perf$recent_tasks","perf","find","rate","total_tasks","Math","round","completed_tasks","style","width","in_progress_tasks","todo_tasks","recent_tasks","t","description","confirmText","cancelText","onConfirm","onCancel","isSubmitting"],"sources":["C:/Users/B Chaitanya Chowdary/Desktop/Task/frontend/src/components/Projects/ProjectMembersModal.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\r\nimport { projectsAPI, authAPI, tasksAPI } from '../../services/api';\r\nimport Card from '../UI/Card';\r\nimport Button from '../UI/Button';\r\nimport Select from '../UI/Select';\r\nimport Badge from '../UI/Badge';\r\nimport LoadingSpinner from '../UI/LoadingSpinner';\r\nimport ConfirmModal from '../UI/ConfirmModal';\r\nimport { Users, Plus, X, User } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst ProjectMembersModal = ({ project, isOpen, onClose }) => {\r\n  const queryClient = useQueryClient();\r\n  const [showAddForm, setShowAddForm] = useState(false);\r\n  const [selectedUser, setSelectedUser] = useState('');\r\n  const [selectedTasks, setSelectedTasks] = useState([]);\r\n  const [showConfirmModal, setShowConfirmModal] = useState(false);\r\n  const [memberToRemove, setMemberToRemove] = useState(null);\r\n\r\n  // Fetch project members\r\n  const { data: members, isLoading: membersLoading } = useQuery(\r\n    ['projectMembers', project?.id],\r\n    () => projectsAPI.getProjectMembers(project.id),\r\n    {\r\n      enabled: !!project && isOpen,\r\n    }\r\n  );\r\n\r\n  // Fetch per-member performance for this project (Scrum Master view)\r\n  const { data: performanceData } = useQuery(\r\n    ['projectMemberPerformance', project?.id],\r\n    () => projectsAPI.getProjectMemberPerformance(project.id),\r\n    {\r\n      enabled: !!project && isOpen,\r\n    }\r\n  );\r\n\r\n  // Fetch all employees for adding to project\r\n  const { data: employees } = useQuery(\r\n    'employees',\r\n    () => authAPI.getEmployees().then(res => res.data || res),\r\n    {\r\n      enabled: showAddForm,\r\n      onSuccess: (data) => {\r\n        console.log('Employees data in ProjectMembersModal:', data);\r\n        console.log('Is array:', Array.isArray(data));\r\n      },\r\n      onError: (error) => {\r\n        console.error('Error fetching employees:', error);\r\n      }\r\n    }\r\n  );\r\n\r\n  // Fetch project tasks for assignment\r\n  const { data: projectTasks } = useQuery(\r\n    ['projectTasks', project?.id],\r\n    () => tasksAPI.getTasks({ project: project.id }),\r\n    {\r\n      enabled: !!project && showAddForm,\r\n      onSuccess: (data) => {\r\n        console.log('Project tasks data:', data);\r\n      },\r\n      onError: (error) => {\r\n        console.error('Error fetching project tasks:', error);\r\n      }\r\n    }\r\n  );\r\n\r\n  // Add member mutation\r\n  const addMemberMutation = useMutation(\r\n    async (memberData) => {\r\n      // First add the member to the project\r\n      const memberResponse = await projectsAPI.addProjectMember(project.id, {\r\n        user: memberData.user,\r\n        role: 'employee' // Default role\r\n      });\r\n      \r\n      // Then assign tasks if any are selected\r\n      if (memberData.tasks && memberData.tasks.length > 0) {\r\n        for (const taskId of memberData.tasks) {\r\n          await tasksAPI.updateTask(taskId, {\r\n            assignee: memberData.user\r\n          });\r\n        }\r\n      }\r\n      \r\n      return memberResponse;\r\n    },\r\n    {\r\n      onSuccess: () => {\r\n        // Invalidate all relevant queries to update everywhere\r\n        queryClient.invalidateQueries(['projectMembers', project.id]);\r\n        queryClient.invalidateQueries(['projectTasks', project.id]);\r\n        queryClient.invalidateQueries(['projectMemberPerformance', project.id]);\r\n        queryClient.invalidateQueries(['taskAnalytics']);\r\n        queryClient.invalidateQueries(['smProjects']);\r\n        queryClient.invalidateQueries(['assignedProjects']);\r\n        queryClient.invalidateQueries(['projectSpecificAnalytics', project.id]);\r\n        \r\n        setSelectedUser('');\r\n        setSelectedTasks([]);\r\n        setShowAddForm(false);\r\n        toast.success('Member added and tasks assigned successfully');\r\n      },\r\n      onError: (error) => {\r\n        toast.error(error.response?.data?.detail || 'Failed to add member');\r\n      },\r\n    }\r\n  );\r\n\r\n  // Remove member mutation\r\n  const removeMemberMutation = useMutation(\r\n    (memberId) => projectsAPI.removeProjectMember(project.id, memberId),\r\n    {\r\n      onSuccess: () => {\r\n        queryClient.invalidateQueries(['projectMembers', project.id]);\r\n        toast.success('Member removed successfully');\r\n      },\r\n      onError: (error) => {\r\n        toast.error(error.response?.data?.detail || 'Failed to remove member');\r\n      },\r\n    }\r\n  );\r\n\r\n  const handleAddMember = (e) => {\r\n    e.preventDefault();\r\n    if (!selectedUser) {\r\n      toast.error('Please select a user');\r\n      return;\r\n    }\r\n\r\n    addMemberMutation.mutate({\r\n      user: selectedUser,\r\n      tasks: selectedTasks,\r\n    });\r\n  };\r\n\r\n  const handleTaskToggle = (taskId) => {\r\n    setSelectedTasks(prev => \r\n      prev.includes(taskId) \r\n        ? prev.filter(id => id !== taskId)\r\n        : [...prev, taskId]\r\n    );\r\n  };\r\n\r\n  const handleRemoveMember = (memberId) => {\r\n    setMemberToRemove(memberId);\r\n    setShowConfirmModal(true);\r\n  };\r\n\r\n  const handleConfirmRemove = () => {\r\n    if (memberToRemove) {\r\n      removeMemberMutation.mutate(memberToRemove);\r\n    }\r\n    setShowConfirmModal(false);\r\n    setMemberToRemove(null);\r\n  };\r\n\r\n  const handleCancelRemove = () => {\r\n    setShowConfirmModal(false);\r\n    setMemberToRemove(null);\r\n  };\r\n\r\n  if (!isOpen || !project) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 overflow-y-auto\">\r\n      <div className=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\r\n        <div className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" onClick={onClose}></div>\r\n\r\n        <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full\">\r\n          <div className=\"bg-white\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b border-gray-200\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"text-lg font-semibold text-gray-900\">\r\n                    Manage - {project.name}\r\n                  </h3>\r\n                  <p className=\"text-sm text-gray-500\">\r\n                    See assigned people, their history and completion rates\r\n                  </p>\r\n                </div>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  <X className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"px-6 py-4\">\r\n              {/* Add Member Button */}\r\n              <div className=\"mb-4\">\r\n                <Button\r\n                  onClick={() => setShowAddForm(!showAddForm)}\r\n                  className=\"flex items-center gap-2\"\r\n                >\r\n                  <Plus className=\"h-4 w-4\" />\r\n                  Add Member\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Add Member Form */}\r\n              {showAddForm && (\r\n                <Card className=\"p-4 mb-4\">\r\n                  <form onSubmit={handleAddMember} className=\"space-y-4\">\r\n                    <div className=\"space-y-4\">\r\n                      <Select\r\n                        label=\"Select Employee *\"\r\n                        value={selectedUser}\r\n                        onChange={(e) => setSelectedUser(e.target.value)}\r\n                        required\r\n                      >\r\n                        <option value=\"\">Choose an employee...</option>\r\n                        {Array.isArray(employees) && employees.map((employee) => (\r\n                          <option key={employee.id} value={employee.id}>\r\n                            {employee.first_name} {employee.last_name} ({employee.email})\r\n                          </option>\r\n                        ))}\r\n                      </Select>\r\n\r\n                      {/* Task Assignment Section */}\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                          Assign Tasks (Optional)\r\n                        </label>\r\n                        <div className=\"max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3 space-y-2\">\r\n                          {projectTasks?.data?.length > 0 ? (\r\n                            projectTasks.data.map((task) => (\r\n                              <label key={task.id} className=\"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded cursor-pointer\">\r\n                                <input\r\n                                  type=\"checkbox\"\r\n                                  checked={selectedTasks.includes(task.id)}\r\n                                  onChange={() => handleTaskToggle(task.id)}\r\n                                  className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                                />\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                  <p className=\"text-sm font-medium text-gray-900 truncate\">\r\n                                    {task.title}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-gray-500\">\r\n                                    Status: {task.status?.replace('_', ' ').toUpperCase()}\r\n                                    {task.priority && ` • Priority: ${task.priority}`}\r\n                                  </p>\r\n                                </div>\r\n                              </label>\r\n                            ))\r\n                          ) : (\r\n                            <div className=\"text-center py-4 text-gray-500 text-sm\">\r\n                              No tasks available for this project\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        {selectedTasks.length > 0 && (\r\n                          <p className=\"text-xs text-gray-600 mt-1\">\r\n                            {selectedTasks.length} task{selectedTasks.length !== 1 ? 's' : ''} selected\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Button\r\n                        type=\"submit\"\r\n                        loading={addMemberMutation.isLoading}\r\n                        disabled={addMemberMutation.isLoading}\r\n                        size=\"sm\"\r\n                      >\r\n                        Add Member\r\n                      </Button>\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        onClick={() => {\r\n                          setShowAddForm(false);\r\n                          setSelectedUser('');\r\n                          setSelectedTasks([]);\r\n                        }}\r\n                        size=\"sm\"\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                    </div>\r\n                  </form>\r\n                </Card>\r\n              )}\r\n\r\n              {/* Members List */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                {membersLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <LoadingSpinner size=\"md\" />\r\n                  </div>\r\n                ) : (() => {\r\n                  // Normalize members response to a flat array\r\n                  const list = Array.isArray(members)\r\n                    ? members\r\n                    : (Array.isArray(members?.data)\r\n                        ? members.data\r\n                        : (members?.data?.results || members?.data || []));\r\n                  const perfMembers = performanceData?.data?.members || [];\r\n                  \r\n                  // Create a Set to track unique user IDs to prevent duplicates\r\n                  const seenUserIds = new Set();\r\n                  \r\n                  // Build combined list with proper deduplication\r\n                  const combined = [];\r\n                  \r\n                  // First, add explicit members\r\n                  list.forEach(m => {\r\n                    if (!seenUserIds.has(m.user)) {\r\n                      seenUserIds.add(m.user);\r\n                      combined.push({\r\n                        id: m.id,\r\n                        user: m.user,\r\n                        user_name: m.user_name,\r\n                        user_email: m.user_email,\r\n                        role: m.role,\r\n                        isExplicitMember: true,\r\n                      });\r\n                    }\r\n                  });\r\n                  \r\n                  // Then add performance members who aren't already explicit members\r\n                  perfMembers.forEach(p => {\r\n                    if (!seenUserIds.has(p.user_id)) {\r\n                      seenUserIds.add(p.user_id);\r\n                      combined.push({\r\n                        id: `assignee-${p.user_id}`,\r\n                        user: p.user_id,\r\n                        user_name: p.name,\r\n                        user_email: p.email,\r\n                        role: 'employee',\r\n                        isExplicitMember: false,\r\n                      });\r\n                    }\r\n                  });\r\n                  if (!combined.length) {\r\n                    return (\r\n                      <div className=\"text-center py-8\">\r\n                        <Users className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n                        <p className=\"text-gray-500\">No members assigned yet</p>\r\n                        <p className=\"text-sm text-gray-400\">Add members to get started</p>\r\n                      </div>\r\n                    );\r\n                  }\r\n                  return (Array.isArray(combined) ? combined : []).map((member) => (\r\n                    <Card key={member.id} className=\"p-4\">\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                            <User className=\"h-5 w-5 text-blue-600\" />\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"font-medium text-gray-900\">{member.user_name}</p>\r\n                            <p className=\"text-sm text-gray-500\">{member.user_email}</p>\r\n                            <Badge \r\n                              variant={member.role === 'scrum_master' ? 'primary' : 'gray'}\r\n                              size=\"sm\"\r\n                              className=\"mt-1\"\r\n                            >\r\n                              {member.role === 'scrum_master' ? 'Scrum Master' : (member.isExplicitMember ? 'Employee' : 'Assignee')}\r\n                            </Badge>\r\n                          </div>\r\n                        </div>\r\n                        {member.isExplicitMember && (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleRemoveMember(member.id)}\r\n                          className=\"text-red-600 hover:text-red-800\"\r\n                        >\r\n                          Remove\r\n                        </Button>\r\n                        )}\r\n                      </div>\r\n\r\n                      {(() => {\r\n                        const perf = performanceData?.data?.members?.find(p => p.user_id === member.user);\r\n                        if (!perf) return null;\r\n                        const rate = perf.total_tasks ? Math.round((perf.completed_tasks / perf.total_tasks) * 100) : 0;\r\n                        return (\r\n                          <div className=\"mt-4\">\r\n                            <div className=\"flex items-center justify-between text-sm text-gray-700 mb-2\">\r\n                              <span>Completion Rate</span>\r\n                              <span className=\"font-semibold\">{rate}%</span>\r\n                            </div>\r\n                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                              <div className=\"bg-green-500 h-2 rounded-full\" style={{ width: `${rate}%` }}></div>\r\n                            </div>\r\n                            <div className=\"mt-3 grid grid-cols-4 gap-3 text-center\">\r\n                              <div>\r\n                                <div className=\"text-xs text-gray-500\">Total</div>\r\n                                <div className=\"text-sm font-semibold\">{perf.total_tasks}</div>\r\n                              </div>\r\n                              <div>\r\n                                <div className=\"text-xs text-gray-500\">Done</div>\r\n                                <div className=\"text-sm font-semibold\">{perf.completed_tasks}</div>\r\n                              </div>\r\n                              <div>\r\n                                <div className=\"text-xs text-gray-500\">In Progress</div>\r\n                                <div className=\"text-sm font-semibold\">{perf.in_progress_tasks}</div>\r\n                              </div>\r\n                              <div>\r\n                                <div className=\"text-xs text-gray-500\">To Do</div>\r\n                                <div className=\"text-sm font-semibold\">{perf.todo_tasks}</div>\r\n                              </div>\r\n                            </div>\r\n                            {perf.recent_tasks?.length ? (\r\n                              <div className=\"mt-3\">\r\n                                <div className=\"text-xs text-gray-500 mb-1\">Recent tasks</div>\r\n                                <ul className=\"space-y-1 text-sm text-gray-700\">\r\n                                  {Array.isArray(perf.recent_tasks) && perf.recent_tasks.map(t => (\r\n                                    <li key={t.id} className=\"flex items-center justify-between\">\r\n                                      <span className=\"truncate mr-2\">{t.title}</span>\r\n                                      <span className=\"text-xs text-gray-500\">{t.status.replace('_',' ')}</span>\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              </div>\r\n                            ) : null}\r\n                          </div>\r\n                        );\r\n                      })()}\r\n                    </Card>\r\n                  ))\r\n                })()}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Footer */}\r\n            <div className=\"px-6 py-4 border-t border-gray-200\">\r\n              <Button\r\n                onClick={onClose}\r\n                className=\"w-full\"\r\n              >\r\n                Close\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Confirmation Modal */}\r\n      <ConfirmModal\r\n        isOpen={showConfirmModal}\r\n        title=\"Remove Member\"\r\n        description=\"Are you sure you want to remove this member from the project? This action cannot be undone.\"\r\n        confirmText=\"Remove Member\"\r\n        cancelText=\"Cancel\"\r\n        variant=\"danger\"\r\n        onConfirm={handleConfirmRemove}\r\n        onCancel={handleCancelRemove}\r\n        isSubmitting={removeMemberMutation.isLoading}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProjectMembersModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}